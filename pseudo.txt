# PROCESS_DIR(dir):
...
for file in dir:
  PROCESS_FILE(file)

# PROCESS_FILE(file):

# Two lists:
ACTIONS <- []
RUNS <- []

# For each file:
action <- {
  date
  label
}

run_globals <- {
  date <- file.filename
  T <- file.lines[1]
  P <- file.lines[2]
}

new buffer;

# crystal section
buffer.from_next_bar()

action.label <- buffer.next_line() + buffer.next_word()
action.date <- buffer.next_line()

# wafer section
buffer.from_next_bar()

wafer_string <- buffer.next_line()
discard(wafer_string)

# runs
while True:

if EOF: exit
buffer.from_next_bar()

run_num <- buffer.next("Run %d")
if run_num == NULL: exit

this_run <- {
  date <- run_globals.date
  number <- run_num
  precusor
  co-reactant
  process
  sequence
  T <- run_globals.T
  P <- run_globals.P
}

run_cycles <- buffer.next("%d Cycles")
this_run.precursor, this_run.co-reactant <- buffer.next("%s|%s")
this_run.process = f"{run_cycles} cycles " + buffer.next_line()
this_run.sequence = buffer.next_line()





